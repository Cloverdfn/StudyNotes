<h1 align="center">实验二：数据查询</h1>

### 一、实验目的:

* 1、掌握SQL语言的数据查询语句

### 二、实验内容：

* 1、将学生成绩数据库（XSCJ）导入SQL SERVER 2008,并做如下查询。（注：数据文件和日志文件从服务器上下载直接导入））

      CREATE DATABASE [XSCJ];

      CREATE TABLE [XSCJ].[dbo].[Course](
        [Cno] [varchar](50) NOT NULL PRIMARY KEY,
        [Cname] [varchar](50) default NULL,
        [Cpno] [varchar](50) default NULL,
        [Ccredit] [varchar](50) default NULL
      )
      INSERT into [XSCJ].[dbo].Course (Cno,Cname,Cpno,Ccredit) values ('1','数据库','5','4');
      INSERT into Course values ('2','数学','','2');
      INSERT into Course values ('3','信息系统','1','4');
      INSERT into Course values ('4','操作系统','6','3');
      INSERT into Course values ('5','数据结构','7','4');
      INSERT into Course values ('6','数据处理','','2');
      INSERT into Course values ('7','PASCAL语言','6','4');
      INSERT into Course values ('8','DB_ S','7','5');



      CREATE TABLE Student(
        [Sno] [varchar](50) NOT NULL PRIMARY KEY,
        [Sname] [varchar](50) default NULL,
        [Sex] [varchar](50) default NULL,
        [Sage] [varchar](50) default NULL,
        [Sdept] [varchar](50) default NULL
      )
      INSERT into Student values ('201215121','李勇','男','20','CS');
      INSERT into Student values ('201215122','刘晨','女','19','CS');
      INSERT into Student values ('201215123','王敏','女','18','MA');
      INSERT into Student values ('201215125','张立','男','19','IS');


      CREATE TABLE SC(
        [Sno] [varchar](50) default NULL,
        [Cno] [varchar](50) default NULL,
        [Grade] [float](10) default NULL
      )
      INSERT into SC values ('201215121','1',92);
      INSERT into SC values ('201215121','2',85);
      INSERT into SC values ('201215121','3',88);
      INSERT into SC values ('201215122','2',90);
      INSERT into SC values ('201215122','3',80);
      INSERT into SC values ('201215123','3',88);

  * (1)查询选修了课程的学生的学号；
  
        select distinct Sno from SC;
        select Sno from Student where Sno in (select Sno from SC);
        select distinct Sno from Student where Sno in (select Sno from SC where Cno is not null);
  
  * (2)查询全体学生的姓名和出生年份，并将列别名改为XM和CSNF;
  
        select Sname XM,2018 - Sage CSNF from Student;
  
  * (3)查询年龄在18到20（包括18岁和20岁）之间学生的学号、姓名和系。
  
        select Sno,Sname,Sdept from Student where Sage between 18 and 20;
        select Sno,Sname,Sdept from Student where Sage >= 18 and Sage <= 20;
  
  * (4)查询信息系（IS）、数学系（MA）和计算机科学系（CS）学生的姓名和性别。
  
        select Sname,Ssex from Student where Sdept in ('IS','MA','CS');
        select Sname,Ssex from Student where Sdept = 'IS' or Sdept = 'MA' or Sdept = 'CS';
  
  * (5)用LIKE查询课程名为DB_S程的课程号和学分。
  
        select Cno,Ccredit from Course where Cname like 'DB_%S';
  
  * (6)查所有有成绩的学生学号和课程号。
  
        select Sno,Cno from SC;
  
  * (7)查询全体学生情况，查询结果按所在系的系号升序排列，同一系中的学生按年龄升序排列。
  
        select * from Student order by Sdept,Sage;
  
  * (8)查询选修了课程的学生人数。
  
        select count(distinct Sno) countSno from SC where Sno in (select Sno from SC group by Sno);
        select count(distinct Sno) countSno from SC;
  
  * (9)计算1号课程的学生平均成绩。
  
        select avg(Grade) from SC where Cno = 1;
  
  * (10)查询有3人以上（含3人）同学选修课程的课程号。
  
        select Cno from SC group by Cno having count(Cno) >= 3;
  
  * (11)查询1号课程的间接先修课。
  
        select c2.Cpno from Course c1,Course c2 where c1.Cno = '1' and c1.Cpno = c2.Cno;
  
  * (12)查询每个学生的学号、姓名、选修的课程名及成绩。
  
        select Student.Sno,Sname,Cname,Grade from Student,SC,Course 
                 where SC.Sno = Student.Sno and SC.Cno = Course.Cno;
  
  * (13)找出每个学生等于他选修课程平均成绩的课程号。

        select Sno,Cno from SC where Grade in (select avg(Grade) from SC group by Cno)

* 2、将以下数据录入上次实验建立的BSXT数据库，并完成以下查询。

<div align="center">Student(学生表)</div>
<div align="center">
      <table>
         <tr>
            <td>学号</td>
            <td>姓名</td>
            <td>性别</td>
            <td>班级</td>
            <td>联系电话</td>
            <td>分组</td>
            <td>密码</td>
         </tr>
         <tr>
            <td>0706034101</td>
            <td>王鹏</td>
            <td>男</td>
            <td>07060341</td>
            <td>13513600001</td>
            <td>1</td>
            <td>123456</td>
         </tr>
         <tr>
            <td>0706034102</td>
            <td>王飞飞</td>
            <td>女</td>
            <td>07060342</td>
            <td>13513600002</td>
            <td>1</td>
            <td>123456</td>
         </tr>
         <tr>
            <td>0706034103</td>
            <td>李夏</td>
            <td>女</td>
            <td>07060342</td>
            <td>13513600003</td>
            <td>2</td>
            <td>123456</td>
         </tr>
         <tr>
            <td>0706034104</td>
            <td>李小东</td>
            <td>男</td>
            <td>07060341</td>
            <td>13513600004</td>
            <td>2</td>
            <td>123456</td>
         </tr>
         <tr>
            <td>0706034105</td>
            <td>代园园</td>
            <td>女</td>
            <td>07060341</td>
            <td>13513600005</td>
            <td>1</td>
            <td>123456</td>
         </tr>
         <tr>
            <td>0706034106</td>
            <td>庞聪</td>
            <td>男</td>
            <td>07060341</td>
            <td>13513600006</td>
            <td>1</td>
            <td>123456</td>
         </tr>
         <tr>
            <td>0706034107</td>
            <td>侯超</td>
            <td>男</td>
            <td>07060342</td>
            <td>13513600007</td>
            <td>2</td>
            <td>123456</td>
         </tr>
      </table>
</div>




<div align="ceneter">Teacher（教师表）</div>

<div align="ceneter">Topic（选题情况表）</div>
